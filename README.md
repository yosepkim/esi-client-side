Original Code from: https://github.com/MrSwitch/esi
